const translations = {
  'zh-CN': {
    title: '缘分测试 | W&T',
    description: '一个专业的缘分测试平台，结合中国玄学（紫微斗数、易经、生肖）和西方占星术。用科学与传统探索你的命运。',
    nav: {
      features: '特色功能',
      how: '使用方法',
      faq: '常见问题',
      contact: '联系我们'
    },
    hero: {
      title: '命运与科学的交汇',
      subtitle: '体验独特的缘分测试，融合中国玄学（紫微斗数、易经、生肖）和西方占星术的智慧。我们的专业算法揭示你们之间的深层联系，提供基于传统和现代科学的见解。',
      cta: '开始缘分测试'
    },
    test: {
      title: '缘分测试',
      yourName: '您的姓名',
      yourBirthday: '您的生日',
      partnerName: '伴侣姓名',
      partnerBirthday: '伴侣生日',
      calculate: '计算缘分'
    },
    features: {
      title: '我们的特色功能',
      eastWest: {
        title: '东西方结合',
        desc: '整合紫微斗数、易经、中国生肖和西方占星术，全面分析你们的关系命运。'
      },
      algorithm: {
        title: '专业算法',
        desc: '我们的专有多维算法结合玄学智慧和科学严谨，提供可靠且富有洞察力的结果。'
      },
      interpretation: {
        title: '深入解读',
        desc: '不仅获得缘分分数，还能得到详细的评分和专业解释，帮助您理解独特的联系。'
      }
    },
    howItWorks: {
      title: '使用方法',
      step1: {
        title: '输入信息',
        desc: '填写双方姓名和生日。'
      },
      step2: {
        title: '智能分析',
        desc: '我们的系统使用玄学和占星算法进行分析。'
      },
      step3: {
        title: '综合报告',
        desc: '获得缘分分数、评级和详细的专业解释。'
      },
      step4: {
        title: '个性化建议',
        desc: '获得量身定制的关系建议和改进技巧。'
      }
    },
    faq: {
      title: '常见问题',
      q1: {
        question: '你们的缘分测试可靠吗？',
        answer: '我们的平台结合中国玄学和西方占星术的深度，使用科学设计的算法，提供高度可信的结果。'
      },
      q2: {
        question: '为什么需要姓名和生日？',
        answer: '姓名和生日对于准确的玄学和占星分析至关重要，包括紫微斗数、易经、生肖和星盘。'
      },
      q3: {
        question: '我的信息安全吗？',
        answer: '所有信息仅用于缘分分析，绝不会与第三方共享。您的隐私是我们的首要任务。'
      },
      q4: {
        question: '服务是免费的吗？',
        answer: '基础缘分测试是免费的。我们很快将推出高级深度付费分析，为寻求更深入见解的用户提供服务。'
      }
    },
    footer: {
      copyright: '版权所有 © 2024 W&T',
      contact: '联系方式：453039687@qq.com',
      description: '一个专业的缘分测试平台，结合中国玄学和西方占星术。'
    },
    testResult: {
      perfectMatch: '完美匹配',
      excellentCompatibility: '极佳缘分',
      promisingConnection: '良好缘分',
      averageFate: '一般缘分',
      challengingBond: '需要努力',
      score: '缘分分数',
      compatibilityRating: '缘分评级',
      overall: '总体评价',
      sameZodiac: '你们拥有相同的西方星座，表明性格高度契合。',
      sameChineseZodiac: '你们拥有相同的生肖，暗示着强大的玄学和谐。',
      sameNameLetter: '你们的名字以相同的字母开头，象征着命中注定的联系。',
      algorithmNote: '我们的算法整合了紫微斗数、易经、中国生肖和西方占星术，为你们的关系提供多维分析。',
      perfectMatchNote: '总的来说，你们是完美的一对，在命运和性格上都有非凡的契合度。请珍惜这份难得的缘分。',
      excellentNote: '你们有极佳的缘分，相互吸引力强，有发展长久关系的潜力。',
      promisingNote: '良好的缘分——通过沟通和理解可以进一步增进你们的感情。',
      averageNote: '一般的缘分——需要付出努力和用心经营这段关系。',
      challengingNote: '这段缘分面临挑战，但通过智慧和耐心，可以改善关系。'
    },
    zodiac: {
      Aries: '白羊座',
      Taurus: '金牛座',
      Gemini: '双子座',
      Cancer: '巨蟹座',
      Leo: '狮子座',
      Virgo: '处女座',
      Libra: '天秤座',
      Scorpio: '天蝎座',
      Sagittarius: '射手座',
      Capricorn: '摩羯座',
      Aquarius: '水瓶座',
      Pisces: '双鱼座'
    },
    chineseZodiac: {
      Rat: '鼠',
      Ox: '牛',
      Tiger: '虎',
      Rabbit: '兔',
      Dragon: '龙',
      Snake: '蛇',
      Horse: '马',
      Goat: '羊',
      Monkey: '猴',
      Rooster: '鸡',
      Dog: '狗',
      Pig: '猪'
    }
  },
  'en': {
    title: 'Fate Compatibility Test | W&T',
    description: 'A professional fate compatibility platform combining Chinese metaphysics (Zi Wei Dou Shu, I Ching, Zodiac) and Western astrology. Discover your destiny with science and tradition.',
    nav: {
      features: 'Features',
      how: 'How it Works',
      faq: 'FAQ',
      contact: 'Contact'
    },
    hero: {
      title: 'Where Destiny Meets Science',
      subtitle: 'Experience a unique compatibility test that blends the wisdom of Chinese metaphysics (Zi Wei Dou Shu, I Ching, Zodiac) with Western astrology. Our professional algorithm reveals the depth of your connection, offering insights grounded in both tradition and modern science.',
      cta: 'Start Your Fate Test'
    },
    test: {
      title: 'Fate Compatibility Test',
      yourName: 'Your Name',
      yourBirthday: 'Your Birthday',
      partnerName: 'Partner\'s Name',
      partnerBirthday: 'Partner\'s Birthday',
      calculate: 'Calculate Compatibility'
    },
    features: {
      title: 'Our Unique Features',
      eastWest: {
        title: 'East Meets West',
        desc: 'Integrating Zi Wei Dou Shu, I Ching, Chinese Zodiac, and Western astrology for a holistic analysis of your relationship destiny.'
      },
      algorithm: {
        title: 'Professional Algorithm',
        desc: 'Our proprietary multi-dimensional algorithm combines metaphysical wisdom and scientific rigor, delivering reliable and insightful results.'
      },
      interpretation: {
        title: 'In-depth Interpretation',
        desc: 'Receive not only a compatibility score, but also a detailed rating and expert explanation, helping you understand your unique connection.'
      }
    },
    howItWorks: {
      title: 'How It Works',
      step1: {
        title: 'Enter Information',
        desc: 'Fill in both names and birthdays.'
      },
      step2: {
        title: 'Intelligent Analysis',
        desc: 'Our system analyzes using a blend of metaphysical and astrological algorithms.'
      },
      step3: {
        title: 'Comprehensive Report',
        desc: 'Get your compatibility score, rating, and a detailed, professional explanation.'
      },
      step4: {
        title: 'Personalized Advice',
        desc: 'Receive tailored relationship advice and improvement tips.'
      }
    },
    faq: {
      title: 'Frequently Asked Questions',
      q1: {
        question: 'Is your compatibility test reliable?',
        answer: 'Our platform combines the depth of Chinese metaphysics and Western astrology, using a scientifically designed algorithm for highly credible results.'
      },
      q2: {
        question: 'Why do you need names and birthdays?',
        answer: 'Names and birthdays are essential for accurate metaphysical and astrological analysis, including Zi Wei Dou Shu, I Ching, Zodiac, and star charts.'
      },
      q3: {
        question: 'Is my information safe?',
        answer: 'All information is used solely for compatibility analysis and will never be shared with third parties. Your privacy is our priority.'
      },
      q4: {
        question: 'Is the service free?',
        answer: 'Basic compatibility tests are free. We will soon launch advanced, in-depth paid analysis for those seeking deeper insights.'
      }
    },
    footer: {
      copyright: '© 2024 W&T. All rights reserved.',
      contact: 'Contact: 453039687@qq.com',
      description: 'A professional fate compatibility platform combining Chinese metaphysics and Western astrology.'
    },
    testResult: {
      perfectMatch: 'Perfect Match',
      excellentCompatibility: 'Excellent Compatibility',
      promisingConnection: 'Promising Connection',
      averageFate: 'Average Fate',
      challengingBond: 'Challenging Bond',
      score: 'Score',
      compatibilityRating: 'Compatibility Rating',
      overall: 'Overall',
      sameZodiac: 'Both share the same Western zodiac sign, indicating high personality resonance.',
      sameChineseZodiac: 'Both share the same Chinese zodiac, suggesting strong metaphysical harmony.',
      sameNameLetter: 'Both names start with the same letter, symbolizing a destined connection.',
      algorithmNote: 'Our algorithm integrates Zi Wei Dou Shu, I Ching, Chinese Zodiac, and Western astrology, providing a multi-dimensional analysis of your relationship.',
      perfectMatchNote: 'Overall, you are a perfect match, with exceptional compatibility in both fate and personality. Consider cherishing this rare bond.',
      excellentNote: 'You have excellent compatibility, with strong mutual attraction and potential for a lasting relationship.',
      promisingNote: 'Promising connection—communication and understanding will further enhance your bond.',
      averageNote: 'Average fate—dedication and effort are needed to nurture this relationship.',
      challengingNote: 'The bond faces challenges, but with wisdom and patience, improvement is possible.'
    },
    zodiac: {
      Aries: 'Aries',
      Taurus: 'Taurus',
      Gemini: 'Gemini',
      Cancer: 'Cancer',
      Leo: 'Leo',
      Virgo: 'Virgo',
      Libra: 'Libra',
      Scorpio: 'Scorpio',
      Sagittarius: 'Sagittarius',
      Capricorn: 'Capricorn',
      Aquarius: 'Aquarius',
      Pisces: 'Pisces'
    },
    chineseZodiac: {
      Rat: 'Rat',
      Ox: 'Ox',
      Tiger: 'Tiger',
      Rabbit: 'Rabbit',
      Dragon: 'Dragon',
      Snake: 'Snake',
      Horse: 'Horse',
      Goat: 'Goat',
      Monkey: 'Monkey',
      Rooster: 'Rooster',
      Dog: 'Dog',
      Pig: 'Pig'
    }
  }
};

// 获取当前语言
function getCurrentLanguage() {
  return localStorage.getItem('language') || 'zh-CN';
}

// 初始化语言切换按钮
function initLanguageSwitcher() {
  const switcher = document.createElement('div');
  switcher.className = 'language-switcher';
  switcher.innerHTML = `
    <button onclick="setLanguage('zh-CN')" class="lang-btn" data-lang="zh-CN">中文</button>
    <button onclick="setLanguage('en')" class="lang-btn" data-lang="en">English</button>
  `;
  document.querySelector('header .container').appendChild(switcher);
  updateLanguageButtons();
}

// 更新语言按钮状态
function updateLanguageButtons() {
  const currentLang = getCurrentLanguage();
  document.querySelectorAll('.lang-btn').forEach(btn => {
    if (btn.dataset.lang === currentLang) {
      btn.classList.add('active');
    } else {
      btn.classList.remove('active');
    }
  });
}

// 设置语言
function setLanguage(lang) {
  localStorage.setItem('language', lang);
  updateContent();
  updateLanguageButtons();
  
  // 如果有测试结果，更新结果的语言
  const fateResult = document.getElementById('fateResult');
  if (!fateResult.classList.contains('hidden')) {
    const yourName = document.getElementById('yourName').value.trim();
    const yourBirthday = document.getElementById('yourBirthday').value;
    const otherName = document.getElementById('otherName').value.trim();
    const otherBirthday = document.getElementById('otherBirthday').value;
    
    if (yourName && yourBirthday && otherName && otherBirthday) {
      const score = getFateScore(yourName, yourBirthday, otherName, otherBirthday);
      const level = getFateLevel(score);
      const reason = getFateReason(yourName, yourBirthday, otherName, otherBirthday, score);
      const t = translations[lang].testResult;
      
      fateResult.innerHTML = `
        <div class="text-2xl font-bold text-blue-700 mb-2">${t.compatibilityRating}: ${level}</div>
        <div class="text-xl mb-2">${t.score}: <span class="font-bold">${score}</span> / 100</div>
        <div class="text-lg text-gray-700">${reason}</div>
      `;
    }
  }
}

// 更新页面内容
function updateContent() {
  const lang = getCurrentLanguage();
  const t = translations[lang];
  
  // 更新页面标题和描述
  document.title = t.title;
  document.querySelector('meta[name="description"]').content = t.description;
  
  // 更新导航
  document.querySelector('.nav-features').textContent = t.nav.features;
  document.querySelector('.nav-how').textContent = t.nav.how;
  document.querySelector('.nav-faq').textContent = t.nav.faq;
  document.querySelector('.nav-contact').textContent = t.nav.contact;
  
  // 更新英雄区域
  document.querySelector('.hero-title').textContent = t.hero.title;
  document.querySelector('.hero-subtitle').textContent = t.hero.subtitle;
  document.querySelector('.hero-cta').textContent = t.hero.cta;
  
  // 更新测试表单
  document.querySelector('.test-title').textContent = t.test.title;
  document.querySelector('label[for="yourName"]').textContent = t.test.yourName;
  document.querySelector('label[for="yourBirthday"]').textContent = t.test.yourBirthday;
  document.querySelector('label[for="otherName"]').textContent = t.test.partnerName;
  document.querySelector('label[for="otherBirthday"]').textContent = t.test.partnerBirthday;
  document.querySelector('.test-calculate').textContent = t.test.calculate;
  
  // 更新特色功能
  document.querySelector('.features-title').textContent = t.features.title;
  document.querySelector('.features-eastwest-title').textContent = t.features.eastWest.title;
  document.querySelector('.features-eastwest-desc').textContent = t.features.eastWest.desc;
  document.querySelector('.features-algorithm-title').textContent = t.features.algorithm.title;
  document.querySelector('.features-algorithm-desc').textContent = t.features.algorithm.desc;
  document.querySelector('.features-interpretation-title').textContent = t.features.interpretation.title;
  document.querySelector('.features-interpretation-desc').textContent = t.features.interpretation.desc;
  
  // 更新使用方法
  document.querySelector('.how-title').textContent = t.howItWorks.title;
  document.querySelector('.how-step1-title').textContent = t.howItWorks.step1.title;
  document.querySelector('.how-step1-desc').textContent = t.howItWorks.step1.desc;
  document.querySelector('.how-step2-title').textContent = t.howItWorks.step2.title;
  document.querySelector('.how-step2-desc').textContent = t.howItWorks.step2.desc;
  document.querySelector('.how-step3-title').textContent = t.howItWorks.step3.title;
  document.querySelector('.how-step3-desc').textContent = t.howItWorks.step3.desc;
  document.querySelector('.how-step4-title').textContent = t.howItWorks.step4.title;
  document.querySelector('.how-step4-desc').textContent = t.howItWorks.step4.desc;
  
  // 更新FAQ
  document.querySelector('.faq-title').textContent = t.faq.title;
  document.querySelector('.faq-q1-question').textContent = t.faq.q1.question;
  document.querySelector('.faq-q1-answer').textContent = t.faq.q1.answer;
  document.querySelector('.faq-q2-question').textContent = t.faq.q2.question;
  document.querySelector('.faq-q2-answer').textContent = t.faq.q2.answer;
  document.querySelector('.faq-q3-question').textContent = t.faq.q3.question;
  document.querySelector('.faq-q3-answer').textContent = t.faq.q3.answer;
  document.querySelector('.faq-q4-question').textContent = t.faq.q4.question;
  document.querySelector('.faq-q4-answer').textContent = t.faq.q4.answer;
  
  // 更新页脚
  document.querySelector('.footer-copyright').textContent = t.footer.copyright;
  document.querySelector('.footer-contact').textContent = t.footer.contact;
  document.querySelector('.footer-description').textContent = t.footer.description;
}

function getFateLevel(score) {
  const lang = getCurrentLanguage();
  const t = translations[lang].testResult;
  if (score >= 90) return t.perfectMatch;
  if (score >= 80) return t.excellentCompatibility;
  if (score >= 70) return t.promisingConnection;
  if (score >= 60) return t.averageFate;
  return t.challengingBond;
}

function getZodiac(month, day) {
  // Western Zodiac
  const zodiacs = [
    [20, "Capricorn"], [19, "Aquarius"], [21, "Pisces"], [21, "Aries"], [21, "Taurus"], [22, "Gemini"],
    [23, "Cancer"], [23, "Leo"], [23, "Virgo"], [23, "Libra"], [23, "Scorpio"], [22, "Sagittarius"], [22, "Capricorn"]
  ];
  const zodiac = day < zodiacs[month-1][0] ? zodiacs[month-1][1] : zodiacs[month][1];
  const lang = getCurrentLanguage();
  return translations[lang].zodiac[zodiac];
}

// 获取生肖英文key（用于内部逻辑）
function getChineseZodiacKey(year) {
  const animals = ["Rat", "Ox", "Tiger", "Rabbit", "Dragon", "Snake", "Horse", "Goat", "Monkey", "Rooster", "Dog", "Pig"];
  return animals[(year - 4) % 12];
}

// 获取生肖显示（用于界面显示）
function getChineseZodiac(year) {
  const key = getChineseZodiacKey(year);
  const lang = getCurrentLanguage();
  return translations[lang].chineseZodiac[key];
}

function getFateReason(yourName, yourBirthday, otherName, otherBirthday, score) {
  const lang = getCurrentLanguage();
  const t = translations[lang].testResult;
  
  const yourYear = parseInt(yourBirthday.slice(0,4));
  const otherYear = parseInt(otherBirthday.slice(0,4));
  const yourZodiac = getZodiac(parseInt(yourBirthday.slice(5,7)), parseInt(yourBirthday.slice(8,10)));
  const otherZodiac = getZodiac(parseInt(otherBirthday.slice(5,7)), parseInt(otherBirthday.slice(8,10)));
  const yourAnimal = getChineseZodiac(yourYear);
  const otherAnimal = getChineseZodiac(otherYear);
  
  let reason = '';
  if (lang === 'zh-CN') {
    reason = `${t.overall}：${yourZodiac}（${yourAnimal}）和${otherZodiac}（${otherAnimal}）。`;
  } else {
    reason = `${t.overall}: ${yourZodiac} (${yourAnimal}) and ${otherZodiac} (${otherAnimal}).`;
  }
  
  if (yourZodiac === otherZodiac) reason += t.sameZodiac + ' ';
  if (yourAnimal === otherAnimal) reason += t.sameChineseZodiac + ' ';
  if (yourName[0] === otherName[0]) reason += t.sameNameLetter + ' ';
  
  reason += t.algorithmNote + ' ';
  
  if (score >= 90) reason += t.perfectMatchNote;
  else if (score >= 80) reason += t.excellentNote;
  else if (score >= 70) reason += t.promisingNote;
  else if (score >= 60) reason += t.averageNote;
  else reason += t.challengingNote;
  
  return reason;
}

function getFateScore(yourName, yourBirthday, otherName, otherBirthday) {
  // 使用名字和生日的组合生成一个确定性的分数
  let baseScore = 60;
  
  // 计算名字相似度
  const nameSimilarity = calculateNameSimilarity(yourName, otherName);
  baseScore += nameSimilarity;
  
  // 计算生日相似度
  const birthdaySimilarity = calculateBirthdaySimilarity(yourBirthday, otherBirthday);
  baseScore += birthdaySimilarity;
  
  // 计算生肖相合度
  const zodiacCompatibility = calculateZodiacCompatibility(yourBirthday, otherBirthday);
  baseScore += zodiacCompatibility;
  
  // 确保分数在0-100之间
  return Math.min(Math.max(baseScore, 0), 100);
}

// 计算名字相似度（0-10分）
function calculateNameSimilarity(name1, name2) {
  let score = 0;
  
  // 首字母相同加5分
  if (name1[0].toLowerCase() === name2[0].toLowerCase()) {
    score += 5;
  }
  
  // 名字长度相近加5分
  const lengthDiff = Math.abs(name1.length - name2.length);
  if (lengthDiff <= 1) {
    score += 5;
  }
  
  return score;
}

// 计算生日相似度（0-15分）
function calculateBirthdaySimilarity(birthday1, birthday2) {
  let score = 0;
  
  // 月份相同加5分
  if (birthday1.slice(5, 7) === birthday2.slice(5, 7)) {
    score += 5;
  }
  
  // 日期相近（相差不超过3天）加5分
  const day1 = parseInt(birthday1.slice(8, 10));
  const day2 = parseInt(birthday2.slice(8, 10));
  if (Math.abs(day1 - day2) <= 3) {
    score += 5;
  }
  
  // 年龄相近（相差不超过3岁）加5分
  const year1 = parseInt(birthday1.slice(0, 4));
  const year2 = parseInt(birthday2.slice(0, 4));
  if (Math.abs(year1 - year2) <= 3) {
    score += 5;
  }
  
  return score;
}

// 计算生肖相合度（0-15分）
function calculateZodiacCompatibility(birthday1, birthday2) {
  const year1 = parseInt(birthday1.slice(0, 4));
  const year2 = parseInt(birthday2.slice(0, 4));
  const animal1 = getChineseZodiacKey(year1); // 用英文key
  const animal2 = getChineseZodiacKey(year2); // 用英文key
  
  // 生肖相合度对照表
  const compatibilityMap = {
    'Rat': { 'Rat': 15, 'Dragon': 10, 'Monkey': 10, 'Ox': 5, 'Tiger': 5, 'Snake': 5, 'Horse': 0, 'Goat': 0, 'Rooster': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Ox': { 'Rat': 5, 'Ox': 15, 'Snake': 10, 'Rooster': 10, 'Tiger': 5, 'Dragon': 5, 'Horse': 0, 'Goat': 0, 'Monkey': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Tiger': { 'Rat': 5, 'Ox': 5, 'Tiger': 15, 'Horse': 10, 'Dragon': 5, 'Snake': 5, 'Goat': 0, 'Monkey': 0, 'Rooster': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Rabbit': { 'Rabbit': 15, 'Goat': 10, 'Pig': 10, 'Dragon': 5, 'Snake': 5, 'Horse': 5, 'Rat': 0, 'Ox': 0, 'Tiger': 0, 'Monkey': 0, 'Rooster': 0, 'Dog': 0 },
    'Dragon': { 'Rat': 10, 'Ox': 5, 'Tiger': 5, 'Dragon': 15, 'Monkey': 10, 'Snake': 5, 'Horse': 0, 'Goat': 0, 'Rooster': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Snake': { 'Rat': 5, 'Ox': 10, 'Tiger': 5, 'Dragon': 5, 'Snake': 15, 'Rooster': 10, 'Horse': 0, 'Goat': 0, 'Monkey': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Horse': { 'Tiger': 10, 'Horse': 15, 'Goat': 10, 'Rabbit': 5, 'Dragon': 0, 'Snake': 0, 'Monkey': 0, 'Rooster': 0, 'Dog': 0, 'Pig': 0, 'Rat': 0 },
    'Goat': { 'Rabbit': 10, 'Horse': 10, 'Goat': 15, 'Pig': 10, 'Tiger': 0, 'Dragon': 0, 'Snake': 0, 'Monkey': 0, 'Rooster': 0, 'Dog': 0, 'Rat': 0 },
    'Monkey': { 'Rat': 10, 'Dragon': 10, 'Monkey': 15, 'Tiger': 0, 'Snake': 0, 'Horse': 0, 'Goat': 0, 'Rooster': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Rooster': { 'Ox': 10, 'Snake': 10, 'Rooster': 15, 'Rat': 0, 'Tiger': 0, 'Dragon': 0, 'Horse': 0, 'Goat': 0, 'Monkey': 0, 'Dog': 0, 'Pig': 0, 'Rabbit': 0 },
    'Dog': { 'Dog': 15, 'Pig': 10, 'Rat': 0, 'Ox': 0, 'Tiger': 0, 'Dragon': 0, 'Snake': 0, 'Horse': 0, 'Goat': 0, 'Monkey': 0, 'Rooster': 0, 'Rabbit': 0 },
    'Pig': { 'Rabbit': 10, 'Goat': 10, 'Dog': 10, 'Pig': 15, 'Rat': 0, 'Ox': 0, 'Tiger': 0, 'Dragon': 0, 'Snake': 0, 'Horse': 0, 'Monkey': 0, 'Rooster': 0 }
  };
  
  return compatibilityMap[animal1][animal2] || 0;
}

// 更新测试结果显示函数
document.getElementById('fateForm').onsubmit = function(e) {
  e.preventDefault();
  const yourName = document.getElementById('yourName').value.trim();
  const yourBirthday = document.getElementById('yourBirthday').value;
  const otherName = document.getElementById('otherName').value.trim();
  const otherBirthday = document.getElementById('otherBirthday').value;
  
  if (!yourName || !yourBirthday || !otherName || !otherBirthday) return;
  
  const score = getFateScore(yourName, yourBirthday, otherName, otherBirthday);
  const level = getFateLevel(score);
  const reason = getFateReason(yourName, yourBirthday, otherName, otherBirthday, score);
  const lang = getCurrentLanguage();
  const t = translations[lang].testResult;
  
  const resultDiv = document.getElementById('fateResult');
  resultDiv.innerHTML = `
    <div class="text-2xl font-bold text-blue-700 mb-2">${t.compatibilityRating}：${level}</div>
    <div class="text-xl mb-2">${t.score}：<span class="font-bold">${score}</span> / 100</div>
    <div class="text-lg text-gray-700">${reason}</div>
  `;
  resultDiv.classList.remove('hidden');
};

// 页面加载完成后初始化
document.addEventListener('DOMContentLoaded', () => {
  initLanguageSwitcher();
  updateContent();
}); 